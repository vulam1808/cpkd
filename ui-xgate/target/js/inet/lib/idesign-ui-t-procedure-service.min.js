$(function(){iNet.ns("iNet.ui.builder","iNet.ui.builder.Procedure");iNet.ui.builder.Procedure=function(){this.id="procedure-div";var c=this,h=null,d=null,k=null,a={page:iNet.resources.builder.page,global:iNet.resources.global,errors:iNet.resources.errors,constant:iNet.resources.constant,validate:iNet.resources.validate},f={BACK:$("#procedure-back-btn"),SUBMIT:$("#procedure-submit-btn")};f.SUBMIT.hide();var i={view:iNet.getUrl("onegate/prodlist"),attach:iNet.getUrl("onegate/formattach"),detach:iNet.getUrl("onegate/formdetach")},
j=new DataSource({columns:[{property:"subject",label:a.page.procedureSubject,sortable:true,disabled:true},{property:"formUI",label:a.page.procedureFormUI,sortable:true,disabled:true,type:"checkbox",width:100},{label:"",type:"action",width:32,align:"center",buttons:[{text:a.page.detach,icon:"icon-unlink",labelCls:"label label-important",fn:function(b){d=b||{};l()},visibled:function(b){return b.formUI||false}}]}]}),g=new iNet.ui.grid.Grid({id:"procedure-grid",url:i.view,convertData:function(b){var e=
b||{};return e.items||[]},dataSource:j,stretchHeight:false,remotePaging:false,editable:true,firstLoad:true,idProperty:"uuid"});g.on("loaded",function(b){d=b||{};f.SUBMIT.hide()});g.on("click",function(b){d=b||{};f.SUBMIT.show()});this.setPageBack=function(b){h=b};this.setData=function(b){k=b;d={}};var l=function(){iNet.isEmpty(d.uuid)?c.notifyError(a.constant.warning_title,c.getNotifyContent(a.constant.warning_error,String.format(a.validate.is_not_found,a.page.procedureSubject))):$.postJSON(i.detach,
{procedure:d.uuid},function(b){console.log(">> result detach >>",b);var e=b||{};if(CommonService.isSuccess(e)){c.notifySuccess(a.constant.submit_title,a.constant.submit_success);g.load()}else c.notifyError(a.constant.submit_title,c.getNotifyContent(a.constant.submit_error,e.errors||[]))},{msg:iNet.resources.ajaxLoading.updating,mask:c.getMask()})};j=function(){if(h!=null){c.hide();h.show()}}.createDelegate(this);f.BACK.on("click",j);f.SUBMIT.on("click",function(){iNet.isEmpty(d.uuid)?c.notifyError(a.constant.warning_title,
c.getNotifyContent(a.constant.warning_error,String.format(a.validate.is_not_found,a.page.procedureSubject))):$.postJSON(i.attach,{page:k.uuid,procedure:d.uuid},function(b){console.log(">> result attach >>",b);var e=b||{};if(CommonService.isSuccess(e)){c.notifySuccess(a.constant.submit_title,a.constant.submit_success);g.load()}else c.notifyError(a.constant.submit_title,c.getNotifyContent(a.constant.submit_error,e.errors||[]))},{msg:iNet.resources.ajaxLoading.updating,mask:c.getMask()})});iNet.ui.builder.Procedure.superclass.constructor.call(this)};
iNet.extend(iNet.ui.builder.Procedure,iNet.ui.app.widget)});