$(function(){iNet.ns("iNet.ui.task");iNet.ui.task.Menu=function(){var k=this,g={},c={},b=$("#sidebar"),l=$("#my-task-refresh-btn"),f=$("#my-task-create-btn");f.hide();var d={formlist:iNet.getUrl("firmtask/process/formlist"),summaryTask:iNet.getUrl("firmtask/process/summary"),processqueue:iNet.getUrl("firmtask/process/queue"),tasktree:iNet.getUrl("onegate/additional/tasktree"),taskquery:iNet.getUrl("onegate/additional/taskquery"),recordcount:iNet.getUrl("onegate/deptrecord/count"),recordsearch:iNet.getUrl("onegate/deptrecord/search"),
additionalreqquery:iNet.getUrl("onegate/externaldata/reqquery")},h=function(){setTimeout(function(){$.each(b.find("li.active"),function(a,e){iNet.isEmpty($(e).attr("assigned")||"")||f.show()})},1E3)},m=function(){k.fireEvent("create")}.createDelegate(this);b.find("li").on("click",function(){f.hide();h()});l.on("click",function(){window.location.href=iNet.getUrl("xgate/page/index")});f.on("click",m);var i=function(){$.postJSON(d.taskquery,{status:"CREATED",assign:false,replyForOrgID:false},function(a){c.expwayprocedureNoWorkflow=
(a||{}).total||0;b.find('#receiver-expway-procedureNoWorkflow [data-type="number"]').text(((a||{}).total||"").toString())});$.postJSON(d.taskquery,{status:"CREATED",assign:true,replyForOrgID:false},function(a){c.expwayprocedureWorkflow=(a||{}).total||0;b.find('#receiver-expway-procedureWorkflow [data-type="number"]').text(((a||{}).total||"").toString())});$.postJSON(d.taskquery,{status:"CREATED",assign:false,replyForOrgID:true},function(a){c.organprocedureNoWorkflow=(a||{}).total||0;b.find('#receiver-organization-procedureNoWorkflow [data-type="number"]').text(((a||
{}).total||"").toString())});$.postJSON(d.taskquery,{status:"CREATED",assign:true,replyForOrgID:true},function(a){c.organprocedureWorkflow=(a||{}).total||0;b.find('#receiver-organization-procedureWorkflow [data-type="number"]').text(((a||{}).total||"").toString())});$.postJSON(d.taskquery,{status:"REFUSE"},function(a){c.refuse=(a||{}).total||0;b.find('#receiver-refuse [data-type="number"]').text(((a||{}).total||"").toString())});$.postJSON(d.additionalreqquery,{},function(a){c.additional=(a||{}).total||
0;b.find('#receiver-additional [data-type="number"]').text(((a||{}).total||"").toString())});$.postJSON(d.recordsearch,{status:"INPROCESS"},function(a){c.inprocess=(a||{}).total||0;b.find('#receiver-inprocess [data-type="number"]').text(((a||{}).total||"").toString())});$.postJSON(d.recordsearch,{status:"COMPLETED"},function(a){c.completed=(a||{}).total||0;b.find('#receiver-completed [data-type="number"]').text(((a||{}).total||"").toString())});$.postJSON(d.recordsearch,{status:"REJECTED"},function(a){c.rejected=
(a||{}).total||0;b.find('#receiver-rejected [data-type="number"]').text(((a||{}).total||"").toString())});$.postJSON(d.recordsearch,{status:"PUBLISHED"},function(a){c.published=(a||{}).total||0;b.find('#receiver-published [data-type="number"]').text(((a||{}).total||"").toString())});$.postJSON(d.processqueue,{},function(a){c.queue=(a||{}).total||0;b.find('#receiver-queue [data-type="number"]').text(((a||{}).total||"").toString())})},j=function(){$.postJSON(d.summaryTask,{},function(a){a=a||[];b.find('#task-open [data-type="number"]').text((a[0]||
"").toString())})};this.setUserProfile=function(a){var e=a||{};iNet.isEmpty(e.uuid)||(g["up"+e.uuid]=e)};this.getUserProfile=function(a){var e=a||"";return iNet.isEmpty(e)?{}:g["up"+e]||{}};this.count=function(a){return c[a]||0};this.refresh=function(a){iNet.roles.receiver&&i(a);iNet.roles.processor&&j(a,"refresh")};this.hideCreate=function(){f.hide()};this.showCreate=function(){f.show()};iNet.roles.receiver&&i();iNet.roles.processor&&j("","create");h();iNet.ui.task.Menu.superclass.constructor.call(this)};
iNet.extend(iNet.ui.task.Menu,iNet.ui.common.Menu)});