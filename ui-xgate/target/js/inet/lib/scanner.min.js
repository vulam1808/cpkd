$(function(){iNet.ns("iNet.ui.scanner");iNet.ui.scanner=function(){this.id="scanner-view-div";var d=this,g=null,j={download:iNet.getUrl("docx/download"),scan:iNet.getUrl("scanner/upload")},k={images:$("#scanner-images")},a={back:$("#scanner-back-btn"),scan:$("#scanner-scan-btn"),upload:$("#scanner-upload-btn"),download:$("#scanner-download-btn")};a.back.hide();this.setPageBack=function(b){g=b;a.back.show()};this.scan=function(){d.show();window.scan();a.upload.hide();a.download.hide()};var l=function(b,
c,e){console.log("__fnScan >>",c,e);var f={};f.scanner_mimetype1=b[c].mimetype;f.scanner_base1=b[c].data;if(!iNet.isEmpty(e))f.docID=e;$.postJSON(j.scan,f,function(m){var h=m||{};if(CommonService.isSuccess(h)){var i=h.uuid||"";console.log(">> scaner index >>",c,b.length-1,h);if(c>=b.length-1){a.download.attr("docID",i);a.download.show();a.back.trigger("click")}else l(b,c+1,i)}else{a.download.attr("docID",i);a.download.show();a.back.trigger("click")}},{mask:d.getMask(),msg:iNet.resources.ajaxLoading.processing})};
k.images.on("change",function(){k.images.html()!=""&&a.upload.show()});a.scan.on("click",function(){window.scan();a.upload.hide();a.download.hide()});a.upload.on("click",function(){window.imagesScanned.length>0?l(window.imagesScanned,0):a.back.trigger("click")}.createDelegate(this));a.download.on("click",function(){var b=a.download.attr("docID")||"";iNet.isEmpty(b)||$.postJSON(j.download,{docID:b},function(c){var e=c||{};CommonService.isSuccess(e)},{mask:d.getMask(),msg:iNet.resources.ajaxLoading.processing});
d.fireEvent("back")}.createDelegate(this));a.back.on("click",function(){d.fireEvent("back");if(g!=null){g.show();d.hide()}}.createDelegate(this));iNet.ui.scanner.superclass.constructor.call(this)};iNet.extend(iNet.ui.scanner,iNet.ui.app.widget)});