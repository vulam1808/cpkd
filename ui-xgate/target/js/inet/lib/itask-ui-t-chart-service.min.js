$(function(){iNet.ns("iNet.ui.task","iNet.ui.task.TChart");iNet.ui.task.TChart=function(){this.id="chart-home-div";var p=this,c=iNet.getLayout().taskMenu;c.on("menuchange",function(){});c.on("create",function(){t()});var j=null,t=function(){if(j==null)j=new iNet.ui.task.TRequest;j.on("finish",function(b){p.show();j.hide();if(!iNet.isEmpty(b)){c.refresh("chart");setTimeout(function(){q()},2E3)}});j.setData({});j.show();p.hide()},e="";e+="<tr>";e+='   <td class="nowrap" data-hash="{2}">';e+='       <span data-action class="chart-number processing">{0}</span>';
e+="       <span>&nbsp; {1}</span>";e+="   </td>";e+='   <td class="nowrap"></td>';e+="</tr>";var d={chart:iNet.resources.receiver.chart,global:iNet.resources.global,errors:iNet.resources.errors,constant:iNet.resources.constant,validate:iNet.resources.validate},r=function(b){if(!iNet.isEmpty(b))iNet.getLayout().location.href=iNet.getUrl("xgate/page/index")+b},o=function(b){var a=b||{},f=a.data||{},k=["#32C8DE","#F00","#FF892A"],l={pie:{show:true,innerRadius:0.4,label:{show:true,radius:0.575,formatter:function(n,
g){return'<div><span  style="font-size:10pt;color:white;">'+g.data[0][1]+"</span></div>"}}}},m={hoverable:false,clickable:true},h={show:false},i={series:l,colors:k,grid:m,legend:h},s=f.process||[];b=$.getCmp(a.idChart);b.unbind();$.plot(b,s,i);f.total>0&&b.append(String.format('<span class="pie-chart-title"><b>{0}</b><br/> {1}</span>',f.total,f.title));b.bind("plotclick",function(n,g,u){r(u.series.hash)});var v=$.getCmp(a.idInfo);$.each(s,function(n,g){v.append(String.format(e,g.data,g.label,g.hash))});
$("[data-hash]").on("click",function(n){var g=$(n.currentTarget).attr("data-hash")||"";r(g)})},q=function(){$("#chart-home-01-chart").html("");$("#chart-home-01-info").html("");$("#chart-home-02-chart").html("");$("#chart-home-02-info").html("");$("#chart-home-03-chart").html("");$("#chart-home-03-info").html("");var b=0,a="",f=[],k=0;a="procedureNoWorkflow";b=c.count("expway"+a);f.push({label:d.chart[a],data:b,hash:"#receiver-expway-"+a});k+=b;a="procedureWorkflow";b=c.count("expway"+a);f.push({label:d.chart[a],
data:b,hash:"#receiver-expway-"+a});k+=b;o({idChart:"chart-home-01-chart",idInfo:"chart-home-01-info",data:{process:f,total:k,title:d.chart.briefcase}});var l=[],m=0;a="procedureNoWorkflow";b=c.count("organ"+a);l.push({label:d.chart[a],data:b,hash:"#receiver-organization-"+a});m+=b;a="procedureWorkflow";b=c.count("organ"+a);l.push({label:d.chart[a],data:b,hash:"#receiver-organization-"+a});m+=b;o({idChart:"chart-home-02-chart",idInfo:"chart-home-02-info",data:{process:l,total:m,title:d.chart.briefcase}});
var h=[],i=0;a="queue";b=c.count(a);h.push({label:d.chart[a],data:b,hash:"#receiver-"+a});i+=b;a="inprocess";b=c.count(a);h.push({label:d.chart[a],data:b,hash:"#receiver-"+a});i+=b;a="completed";b=c.count(a);h.push({label:d.chart[a],data:b,hash:"#receiver-"+a});i+=b;a="rejected";b=c.count(a);h.push({label:d.chart[a],data:b,hash:"#receiver-"+a});i+=b;a="published";b=c.count(a);h.push({label:d.chart[a],data:b,hash:"#receiver-"+a});i+=b;o({idChart:"chart-home-03-chart",idInfo:"chart-home-03-info",data:{process:h,
total:i,title:d.chart.briefcase}})};$(window).on("load",function(){setTimeout(function(){q()},2E3)});iNet.ui.task.TChart.superclass.constructor.call(this)};iNet.extend(iNet.ui.task.TChart,iNet.ui.app.widget);(new iNet.ui.task.TChart).show()});