$(function(){var c={common:ita.resources.common,validate:ita.resources.validate},g={view:iNet.getUrl("ita/province/load"),save:iNet.getUrl("ita/province/save"),update:iNet.getUrl("ita/province/update"),del:iNet.getUrl("ita/province/delete")};iNet.ns("iNet.ui","iNet.ui.ita");iNet.ui.ita.ProvinceListWidget=function(h){var j=h||{};iNet.apply(this,j);this.id=this.id||"province-widget";iNet.ui.ita.ProvinceListWidget.superclass.constructor.call(this);var a=this;h=new iNet.ui.grid.DataSource({columns:[{property:"code",
label:c.common.code,sortable:true,type:"text",validate:function(b){if(iNet.isEmpty(b))return"Code must not be empty"}},{property:"name",label:c.common.name,sortable:true,type:"text",validate:function(b){if(iNet.isEmpty(b))return"Name must not be empty"}},{label:"",type:"action",separate:"&nbsp;",align:"center",cls:"hidden-767",buttons:[{text:"Edit",icon:"icon-pencil",labelCls:"label label-info",fn:function(b){console.log(b);a.grid.edit(b[a.grid.getIdProperty()])}},{text:"Delete",icon:"icon-trash",
labelCls:"label label-important",fn:function(b){var e=b||{},f={uuid:b[a.grid.getIdProperty()]};console.log("delete>>",f);$.postJSON(g.del,f,function(d){var i=d||{};if(CommonService.isSuccess(i)){a.grid.remove(b[a.grid.getIdProperty()]);a.notifySuccess(c.validate.save_title,c.validate.delete_success)}else a.notifyError(c.validate.save_title,a.getNotifyContent(c.validate.delete_error,i.errors||[]))})}}]}]});this.grid=new iNet.ui.grid.Grid({id:"province-grid",dataSource:h,url:g.view,firstLoad:true,idProperty:"uuid",
pageSize:10,convertData:function(b){var e=b||{},f=e.items||[];return f},editable:false});this.grid.on("save",function(b){var e=b||{};console.log("saved>>",e);$.postJSON(g.save,e,function(f){var d=f||{};if(CommonService.isSuccess(d)){a.grid.insert(d);a.notifySuccess(c.validate.save_title,c.validate.save_success)}else{a.grid.newRecord();a.notifyError(c.validate.save_title,a.getNotifyContent(c.validate.save_error,d.errors||[]))}})}.createDelegate(this));this.grid.on("update",function(b){var e=b||{};
console.log("updated>>",e);$.postJSON(g.update,e,function(f){var d=f||{};if(CommonService.isSuccess(d)){a.grid.update(d);a.grid.commit();a.notifySuccess(c.validate.save_title,c.validate.update_success)}else a.notifyError(c.validate.save_title,a.getNotifyContent(c.validate.update_error,d.errors||[]))})}.createDelegate(this));$("#province-btn-add").on("click",function(){a.grid.newRecord()}.createDelegate(this))};iNet.extend(iNet.ui.ita.ProvinceListWidget,iNet.ui.app.widget);(new iNet.ui.ita.ProvinceListWidget).show()});