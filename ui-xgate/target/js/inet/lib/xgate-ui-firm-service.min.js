$(function(){iNet.ns("iNet.ui.admin","iNet.ui.admin.Firm");iNet.ui.admin.Firm=function(){this.id="firm-div";var c=this,e=null,a={firm:iNet.resources.xgate.admin.firm,global:iNet.resources.global,errors:iNet.resources.errors,constant:iNet.resources.constant,validate:iNet.resources.validate},h={CREATE:$("#firm-create-btn"),DEL:$("#firm-delete-btn")},i={view:iNet.getUrl("firmtask/subfirm/list"),del:iNet.getUrl("firmtask/subfirm/delete")},d=this.confirmDialog(a.constant.del_title,c.getNotifyContent(a.constant.del_content,
""),function(){if(!iNet.isEmpty(d.params||{})){d.hide();$.postJSON(i.del,d.params,function(b){var f=b||{};if(CommonService.isSuccess(f)){g.remove(f.uuid);d.params={};c.notifySuccess(a.constant.del_title,a.constant.del_success)}else c.notifyError(a.constant.del_title,c.getNotifyContent(a.constant.del_error,f.errors||[]))},{mask:c.getMask(),msg:iNet.resources.ajaxLoading.deleting})}}),k=new DataSource({columns:[{property:"organiId",label:a.firm.organId,sortable:true,disabled:true},{property:"name",
label:a.firm.name,sortable:true,disabled:true},{property:"email",label:a.firm.email,sortable:true,disabled:true},{property:"phone",label:a.firm.phone,sortable:true,disabled:true},{property:"fax",label:a.firm.fax,sortable:true,disabled:true},{label:"",type:"action",width:32,align:"center",buttons:[{text:iNet.resources.message.button.edit,icon:"icon-pencil",labelCls:"label label-success",fn:function(b){j(b)}},{text:iNet.resources.message.button.del,icon:"icon-trash",labelCls:"label label-important",
fn:function(b){d.params={organiId:b.organiId,profileID:b.profileID};d.setContent(String.format(a.constant.del_content,b.name));d.show()}}]}],delay:250}),g=new iNet.ui.grid.Grid({id:"firm-grid",url:i.view,params:{},convertData:function(b){var f=b||{};return f.items},dataSource:k,stretchHeight:false,editable:false,firstLoad:true,idProperty:"uuid"});g.on("click",function(){});g.on("loaded",function(){});var j=function(b){if(e==null)e=new iNet.ui.admin.FirmView;e.on("finish",function(){g.load()});e.setData(b);
e.setPageBack(c);e.show();c.hide()};h.CREATE.on("click",function(){j({})});h.DEL.on("click",function(){});iNet.ui.admin.Firm.superclass.constructor.call(this)};iNet.extend(iNet.ui.admin.Firm,iNet.ui.app.widget);(new iNet.ui.admin.Firm).show()});